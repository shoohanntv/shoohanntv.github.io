<!DOCTYPE html>
<html>
<head>
  <title>Footfy</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.6/shaka-player.ui.min.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.6/controls.min.css" crossorigin="anonymous">

  <style>
    body { margin:0; background:black; overflow:hidden; }
    .shaka-spinner-container { display: none; }
    .video-fill video { object-fit: cover; }
    .shaka-bottom-controls { display: flex; flex-direction: column-reverse; }

    a#join-tg span {
      position:absolute; z-index:100; top:6px; left:5px;
      height:30px; width:100px;
      color:#ccc; border:2px solid #ccc;
      text-align:center; line-height:26px;
      font-family:sans-serif;
    }
  </style>
</head>

<body oncontextmenu="return false" onkeydown="return false" onmousedown="return false">

  <div id="videoContainer" class="container video-fill"
       data-shaka-player-container
       style="position:absolute; top:0; left:0; width:100%; height:100%;">
       
    <video id="video"
           autoplay
           controls
           data-shaka-player
           poster="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhQlKKq96zIzlTvzhm0hzs-qi0-Gfskxneo2G0V8TavGi4H0bLHq_nD5rVBZM8ZmMTprSHDmed-LwQ7781_KbEfvE31nzEjZzkFw4csi2vc1FXVx59EnkbGYFuk7zVpnbgLqbIpjrOdQQyx4iA5R6-9avGn871yRZN039cJEup6UswrJcGAY1G_WYeFSjs/s1600/Pleae%20wait%20a%20moment%20%281%29.webp"
           style="width:100%; height:100%;">
    </video>
  </div>

  <a href="https://t.me/game24x" target="_blank" id="join-tg">
    <span>Join us</span>
  </a>

  <script>
    async function init() {
      const params = new URLSearchParams(window.location.search);

      const mpd = params.get("mpd");
      const kid = params.get("kid");
      const key = params.get("key");

      if (!mpd || !kid || !key) {
        alert("Missing mpd / kid / key");
        return;
      }

      const video = document.getElementById('video');
      const ui = video['ui'];

      // UI config
      ui.configure({
        addBigPlayButton: true,
        controlPanelElements: [
          "play_pause", "time_and_duration", "spacer",
          "quality", "volume", "fullscreen"
        ],
        seekBarColors: {
          base: 'rgba(255,255,255,0.3)',
          buffered: 'rgba(255,255,255,0.54)',
          played: 'rgb(255,0,0)'
        }
      });

      const controls = ui.getControls();
      const player = controls.getPlayer();

      // DRM config (ClearKey)
      player.configure({
        drm: {
          clearKeys: {
            [kid]: key
          }
        },
        streaming: {
          bufferingGoal: 60,
          rebufferingGoal: 2,
          lowLatencyMode: true
        }
      });

      try {
        await player.load(mpd);
        await video.play();
        console.log("Stream loaded");
      } catch (e) {
        console.error("Playback error", e);
      }
    }

    document.addEventListener('shaka-ui-loaded', init);

    window.addEventListener('resize', () => {
      const c = document.getElementById('videoContainer');
      c.style.width = innerWidth + 'px';
      c.style.height = innerHeight + 'px';
    });
  </script>

</body>
</html>
